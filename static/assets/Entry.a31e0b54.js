import{d as Z,l as Y,c as E,k as t,i as ee,F as te,t as ie,z as le}from"./@vue.f0a33739.js";import{u as ae,r as ne,U as x,S as d,a as oe}from"./index.920e9a46.js";import{C as se}from"./CalendarStore.cb580ddd.js";import{u as ce}from"./MeetingStore.f0da8e2c.js";import{d as $}from"./avator_red.2a3a1020.js";import{d as w}from"./itb_logo_gray.5050f3d7.js";import{F as I,h as k,R as re,T as de,e as f,S as g,m as c}from"./ant-design-vue.5bef4758.js";import{h as U}from"./moment.29305b8e.js";import{u as ue}from"./vue-i18n.df730e9c.js";import{d as u}from"./vue-router.85e08d32.js";import{J as me}from"./@ant-design.a109b705.js";const _e="_contentWrap_1wu7g_1",be="_content_1wu7g_1",ge="_img_c1_1wu7g_10",fe="_c2_1wu7g_21",pe="_img_c2_1wu7g_26",ve="_c4_1wu7g_42",he="_img_c4_1wu7g_49",xe="_logo_1wu7g_65",$e="_logotext_1wu7g_70",we="_divline_1wu7g_77",Ie="_divline2_1wu7g_83",ke="_btnMeeting_1wu7g_89",Me="_enewie_1wu7g_93",Se="_code_1wu7g_97";var i={contentWrap:_e,content:be,img_c1:ge,c2:fe,img_c2:pe,c4:ve,img_c4:he,logo:xe,logotext:$e,divline:we,divline2:Ie,btnMeeting:ke,enewie:Me,code:Se};function p(v){return typeof v=="function"||Object.prototype.toString.call(v)==="[object Object]"&&!ee(v)}var Re=Z({props:{detailedMapItem:{type:Object,required:!1}},setup(v){var H,O;const{t:a}=ue(),{appStore:b}=oe(),{authenStore:m}=ae(),{detailedMapItem:s}=v,{meetingStore:h}=ce();let M=-1;ne.currentRoute.value.fullPath.indexOf("virtual")>=0?M=1:M=0;const S=Y(!1);function q(e){return!e||e.indexOf("http://")===0||e.indexOf("https://")===0?e:`${d}${e.replace(/\\/g,"/")}`}function R(e,l){let n,_;return t("div",{style:"width:100%"},[t("div",null,[t(g,{size:50},{default:()=>[t(u,{to:e.list[0].exhibition_barcode.substr(0,1)==="7"?`/exhibitors/${e.list[0].e_parent_barcode}`:`/exhibitors/${e.list[0].exhibition_barcode}`},{default:()=>[t("div",{class:i.logo},[t("div",{class:"squareItem2 "},[e.list[0].e_logoUrl!=null&&e.list[0].e_logoUrl!=""?t("img",{src:`${d}${e.list[0].e_logoUrl}`},null):t("img",{src:w},null)])])]}),t("div",{class:i.divline},null),e.list.map((o,y)=>t(u,{to:`/buyer/${o.buyer_barcode}`},{default:()=>[t("div",{class:i.logo},[t("div",{class:"squareItem2 "},[o.b_company_logo!=null&&o.b_company_logo!=""?t("img",{src:`${d}${o.b_company_logo}`},null):t("img",{src:w},null)])])]}))]})]),t("div",null,[t(g,{size:50},{default:()=>[t("div",{class:i.logotext},[b.isEn?e.list[0].e_company:e.list[0].e_company_cn]),t("div",{class:i.divline2},null),e.list.map((o,y)=>t("div",{class:i.logotext},[b.isEn?o.b_company:o.b_company_cn]))]})]),t("p",null,null),t("div",null,[t(g,{size:50},{default:()=>[t(u,{to:e.list[0].exhibition_barcode.substr(0,1)==="7"?`/exhibitors/${e.list[0].e_parent_barcode}/contact/${e.list[0].exhibition_barcode}`:`/exhibitors/${e.list[0].exhibition_barcode}/contact/${e.list[0].exhibition_barcode}`},{default:()=>[t("div",{class:i.logo},[t("div",{class:"squareItem2"},[e.list[0].e_headimageurl!=null&&e.list[0].e_headimageurl!=""?t("img",{src:`${d}${e.list[0].e_headimageurl}`},null):t("img",{src:$},null)])])]}),t("div",{class:i.divline},null),e.list.map((o,y)=>t(u,{to:`/buyer/${o.buyer_barcode}`},{default:()=>[t("div",{class:i.logo},[t("div",{class:"squareItem2 "},[o.b_headimageurl!=null&&o.b_headimageurl!=""?t("img",{src:`${d}${o.b_headimageurl}`},null):t("img",{src:$},null)])])]}))]})]),t("div",null,[t(g,{size:50},{default:()=>[t("div",{class:i.logotext},[b.isEn?e.list[0].e_firstname+" "+e.list[0].e_lastname:e.list[0].e_lastname_cn+e.list[0].e_firstname_cn]),t("div",{class:i.divline2},null),e.list.map((o,y)=>t("div",{class:i.logotext},[b.isEn?o.b_firstname+" "+o.b_lastname:o.b_lastname_cn+o.b_firstname_cn]))]})]),t("div",{class:i.btnMeeting},[e.metting_pwd!=null&&e.metting_pwd!=""?t("span",{class:`text_red text_bold ${i.enewie}`},[a("calendar.meeting.meeting_pwd")+" ",e.metting_pwd]):t("span",{class:`text_red text_bold ${i.enewie}`},null),e.metting_pwd!=null&&e.metting_pwd!=""?t("span",{class:`text_red text_bold ${i.enewie}`},[a("calendar.meeting.meeting_pwd")+" ",e.metting_pwd]):t("span",{class:`text_red text_bold ${i.enewie}`},null),t(f,{type:"primary",class:i.enewie,onClick:G},p(n=a("calendar.meeting.evaluate"))?n:{default:()=>[n]}),l==="byItb"?t(f,{type:"primary",class:i.enewie,onClick:()=>K(C(e))},p(_=a("calendar.meeting.delete"))?_:{default:()=>[_]}):t("span",null,null)])])}function z(e){let l=q(e.activity_coverpicture);return t(u,{to:`/Conference/${e.activity_content_id}`},{default:()=>[t("div",{class:i.img_c1,style:{backgroundImage:`url(${l})`}},null)]})}function F(e){var _;let l,n;return console.log(e),t("div",{style:"width:100%"},[t("div",null,[t(g,{size:50},{default:()=>[t(u,{to:e.exhibition_barcode.substr(0,1)==="7"?`/exhibitors/${e.e_parent_barcode}`:`/exhibitors/${e.exhibition_barcode}`},{default:()=>[t("div",{class:i.logo},[t("div",{class:"squareItem2 "},[e.e_logoUrl!=null&&e.e_logoUrl!=""?t("img",{src:`${d}${e.e_logoUrl}`},null):t("img",{src:w},null)])])]}),t("div",{class:i.divline},null),e.buyer_barcode.substr(0,1)==="1"||e.buyer_barcode.substr(0,1)==="4"||e.buyer_barcode.substr(0,1)==="7"?t(u,{to:e.buyer_barcode.substr(0,1)==="7"?`/exhibitors/${e.b_parent_barcode}`:`/exhibitors/${e.buyer_barcode}`},{default:()=>[t("div",{class:i.logo},[t("div",{class:"squareItem2 "},[e.b_company_logo!=null&&e.b_company_logo!=""?t("img",{src:`${d}${e.b_company_logo}`},null):t("img",{src:w},null)])])]}):t(u,{to:`/buyer/${e.buyer_barcode}`},{default:()=>[t("div",{class:i.logo},[t("div",{class:"squareItem2 "},[e.b_company_logo!=null&&e.b_company_logo!=""?t("img",{src:`${d}${e.b_company_logo}`},null):t("img",{src:w},null)])])]})]})]),t("div",null,[t(g,{size:50},{default:()=>[t("div",{class:i.logotext},[b.isEn?e.e_company:e.e_company_cn]),t("div",{class:i.divline2},null),t("div",{class:i.logotext},[b.isEn?e.b_company:e.b_company_cn])]})]),t("p",null,null),t("div",null,[t(g,{size:50},{default:()=>[t(u,{to:e.exhibition_barcode.substr(0,1)==="7"?`/exhibitors/${e.e_parent_barcode}/contact/${e.exhibition_barcode}`:`/exhibitors/${e.exhibition_barcode}/contact/${e.exhibition_barcode}`},{default:()=>[t("div",{class:i.logo},[t("div",{class:"squareItem2"},[e.e_headimageurl!=null&&e.e_headimageurl!=""?t("img",{src:`${d}${e.e_headimageurl}`},null):t("img",{src:$},null)])])]}),t("div",{class:i.divline},null),e.buyer_barcode.substr(0,1)==="1"||e.buyer_barcode.substr(0,1)==="4"||e.buyer_barcode.substr(0,1)==="7"?t(u,{to:e.buyer_barcode.substr(0,1)==="7"?`/exhibitors/${e.b_parent_barcode}`:`/exhibitors/${e.buyer_barcode}`},{default:()=>[t("div",{class:i.logo},[t("div",{class:"squareItem2 "},[e.b_headimageurl!=null&&e.b_headimageurl!=""?t("img",{src:`${d}${e.b_headimageurl}`},null):t("img",{src:$},null)])])]}):t(u,{to:`/buyer/${e.buyer_barcode}`},{default:()=>[t("div",{class:i.logo},[t("div",{class:"squareItem2 "},[e.b_headimageurl!=null&&e.b_headimageurl!=""?t("img",{src:`${d}${e.b_headimageurl}`},null):t("img",{src:$},null)])])]})]})]),t("div",null,[t(g,{size:50},{default:()=>[t("div",{class:i.logotext},[b.isEn?e.e_firstname+" "+e.e_lastname:e.e_lastname_cn+e.e_firstname_cn]),t("div",{class:i.divline2},null),t("div",{class:i.logotext},[b.isEn?e.b_firstname+" "+e.b_lastname:e.b_lastname_cn+e.b_firstname_cn])]})]),ie(t("div",{class:i.btnMeeting},[t(f,{type:"primary",class:i.enewie,onClick:()=>X(e.id,e.begin_datetime)},p(l=a("calendar.meeting.accept"))?l:{default:()=>[l]}),t(f,{class:i.enewie,onClick:()=>Q(e.id)},p(n=a("calendar.meeting.deny"))?n:{default:()=>[n]})]),[[le,((_=m.user)==null?void 0:_.barcode)!==e.initiator_barcode]])])}function C(e){var n;let l=0;return e.list[0].exhibition_barcode===((n=m.user)==null?void 0:n.barcode)?Number(e.id):(e.list.map(_=>{var o;_.buyer_barcode===((o=m.user)==null?void 0:o.barcode)&&(l=Number(_.id))}),l)}function A(e){if(e.type==="byItb"||e.type==="byMe"){let l=e.entry;return R(l,e.type)}else if(e.type==="conference"){let l=e.entry;return z(l)}else{let l=e.entry;return F(l)}}function W(e){return t("div",{class:i.content},[e.metting_title])}function L(e){return t("div",{class:i.content},[t("b",null,[e.activity_title]),t("br",null,null),e.actitivity_content_title,t("br",null,null),e.location])}function N(e){}function V(e){if(e.type==="byItb"||e.type==="byMe"){let l=e.entry;return W(l)}else if(e.type==="conference"){let l=e.entry;return L(l)}else return e.entry,N()}const B=I.useForm,D=Y(),r=E({rate:3,content:"",Action:"1",barcode:(O=(H=m.user)==null?void 0:H.barcode)!=null?O:"",Type:"2",SubscribeId:"",activitycontentid:"",isAdded:void 0}),T=E({}),{resetFields:J}=B(r,T),j=Y(a("conference.rateValues").split(","));async function P(){try{await D.value.validate();let e=s==null?void 0:s.entry;h.addEvaluate(r.rate,r.content,~~e.id,m.user.barcode,e.type)}catch(e){console.log("error",e)}}async function G(){S.value=!0;let e=await h.getEvaluate(C(s==null?void 0:s.entry));r.rate=e.rate,r.content=e.content}function K(e){k.confirm({content:t("div",{innerHTML:a("calendar.meeting.comfirm_title4")+"<br/>"+a("calendar.meeting.comfirm_title")},null),onOk:async()=>{try{await h.deleteMeeting(e,M)?(c.success(a("common.success")),location.reload()):c.error(a("common.failed"))}catch(l){switch(l.message){case"error_msg_01":case"error_msg_02":case"error_msg_03":c.error(a(`calendar.delete_meeting_errors.${l.message}`));break;default:c.error(l.message)}}},okText:a("calendar.blockTime.confirm_okbtn"),onCancel:()=>{},cancelText:a("calendar.blockTime.confirm_cancelbtn")})}function Q(e){k.confirm({content:t("div",null,[a("calendar.meeting.comfirm_title2")]),onOk:async()=>{try{let l=-1;await h.accept(e,l)?(c.success(a("common.success")),location.reload()):c.error(a("common.failed"))}catch(l){switch(l.message){case"error_msg_001":c.error(a(`calendar.deny_meeting_errors.${l.message}`));break;default:c.error(l.message)}}},okText:a("calendar.blockTime.confirm_okbtn"),onCancel:()=>{},cancelText:a("calendar.blockTime.confirm_cancelbtn")})}function X(e,l){if(U(x(l,m.minutesOffset,"YYYY-MM-DD HH:mm:ss")).diff(Date.now(),"hour")<=4){c.info(a("calendar.meeting.comfirm_title5"));return}else k.confirm({content:t("div",null,[a("calendar.meeting.comfirm_title3")]),onOk:async()=>{try{let n=1;await h.accept(e,n)?(c.success(a("common.success")),location.reload()):c.error(a("common.failed"))}catch(n){switch(n.message){case"error_msg_001":c.error(a(`calendar.deny_meeting_errors.${n.message}`));break;default:c.error(n.message)}}},okText:a("calendar.blockTime.confirm_okbtn"),onCancel:()=>{},cancelText:a("calendar.blockTime.confirm_cancelbtn")})}return()=>{let e,l;return t(te,null,[s&&t("div",{class:"pd_20"},[t("div",{class:"gridCols2"},[t("div",{class:"text_left",style:{color:se[s.color],fontWeight:600}},[a(`calendar.colors_map.${s.color}`)]),t("div",{class:"text_right"},[s.type==="unconfirmed"?x(s.entry.begin_datetime,m.minutesOffset,"YYYY-MM-DD HH:mm:ss")+" - "+x(s.entry.end_datetime,m.minutesOffset,"YYYY-MM-DD HH:mm:ss"):s.type==="conference"?U(s.entry.actitivity_content_begindate).format("YYYY-MM-DD")+" "+s.entry.actitivity_content_time:x(s.entry.begindate,m.minutesOffset,"YYYY-MM-DD HH:mm:ss")+" - "+x(s.entry.enddate,m.minutesOffset,"YYYY-MM-DD HH:mm:ss")])]),t("div",{class:`pd_tb_20 ${i.contentWrap}`},[A(s),V(s)]),t("hr",null,null)]),t(k,{visible:S.value,"onUpdate:visible":n=>S.value=n,width:580,centered:!0,footer:null},{default:()=>[t(I,{ref:D,model:r,rules:T},{default:()=>[t(I.Item,null,{default:()=>[t(re,{value:r.rate,"onUpdate:value":n=>r.rate=n,tooltips:j.value},{character:()=>t(me,null,null)}),t("span",{class:"ant-rate-text"},[j.value[r.rate-1]])]}),t(I.Item,null,{default:()=>[t(de,{value:r.content,"onUpdate:value":n=>r.content=n,placeholder:a("conference.comment"),allowClear:!0,autoSize:{minRows:3,maxRows:6}},null)]}),t(I.Item,{style:{textAlign:"right"}},{default:()=>[t(f,{onClick:J},p(e=a("common.reset"))?e:{default:()=>[e]}),t(f,{type:"primary",style:"margin-left: 10px",onClick:P},p(l=a("common.submit"))?l:{default:()=>[l]})]})]})]})])}}});export{Re as E};
