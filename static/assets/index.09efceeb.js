var e=Object.defineProperty,t=(t,n,r)=>(((t,n,r)=>{n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r})(t,"symbol"!=typeof n?n+"":n,r),r);import{B as n,p as r,l as o}from"./index.87ee659d.js";import{au as i,a2 as a,c as s,a0 as l,$ as c,k as p,aq as u,r as d,ag as v,I as m}from"./@vue.5723de44.js";import{T as h,r as y,F as f,m as g,n as b,I as B,l as R,u as x,s as j}from"./ant-design-vue.b2a91f0d.js";import{u as S}from"./vue-i18n.bbad715b.js";import{s as w}from"./index.module.8f1aa0e0.js";import"./vue-router.0532eeed.js";import"./moment.29305b8e.js";import"./@ant-design.a9421c3d.js";import"./@ctrl.2e36ce53.js";import"./nprogress.3e43c680.js";import"./axios.a57df465.js";import"./@babel.288dabcc.js";import"./regenerator-runtime.8463e994.js";import"./omit.js.0925d6dc.js";import"./lodash-es.bcdd4346.js";import"./warning.4abaefa0.js";import"./resize-observer-polyfill.8deb1e21.js";import"./async-validator.1fa0d626.js";import"./scroll-into-view-if-needed.c68eec67.js";import"./compute-scroll-into-view.6058b3be.js";import"./vue-types.6e6d84ba.js";import"./dom-align.f1b5d360.js";import"./@intlify.c2b61631.js";import"./source-map.3671d69c.js";import"./vue.3a1030aa.js";var I,L,q=Object.defineProperty,k=Object.getOwnPropertyDescriptor,A=(e,t,n,r)=>{for(var o,i=r>1?void 0:r?k(t,n):t,a=e.length-1;a>=0;a--)(o=e[a])&&(i=(r?o(t,n,i):o(i))||i);return r&&i&&q(t,n,i),i};(L=I||(I={})).furniture="furniture",L.power="power",L.other="other";class T extends n{constructor(e){super(),t(this,"reserveType"),t(this,"currentLng"),t(this,"resourceList"),t(this,"serviceList"),t(this,"sumApplyPrice",0),t(this,"sumServicePrice",0),t(this,"pageIndex",0),t(this,"pageSize",10),t(this,"totalRecords",0),this.reserveType=e}async fetchServiceList(e,t){let n=await r("Operation/Getservicelistbyuser",{reservetype:this.reserveType,currentlng:this.currentLng,pageIndex:e,pageSize:t||this.pageSize});this.serviceList=n.results,this.pageIndex=e,this.totalRecords=n.totalRecord}async getServiceSum(){var e;let t=await r("Operation/Getservicelisttotalsumbyuser",{pageIndex:0,reservetype:this.reserveType,currentlng:this.currentLng});return this.sumServicePrice=(null==(e=t[0])?void 0:e.totalsum)||0,this.sumServicePrice}async fetchResources(){let e=await r("Operation/getAllresource",{reservetype:this.reserveType,currentlng:this.currentLng});e.forEach((e=>{e.quantity=0})),this.resourceList=e}caculateSum(){var e;let t=0;null==(e=this.resourceList)||e.forEach((e=>{t+=e.quantity*e.unitprice})),this.sumApplyPrice=t}async postResourceApply(e,t,n){var o,i;const a=null==(o=this.resourceList)?void 0:o.map((e=>e.itemno)).join("|"),s=null==(i=this.resourceList)?void 0:i.map((e=>e.quantity)).join("|");await r("/Operation/AddResource",{reservetype:this.reserveType,currentlng:this.currentLng,contactperson:e,contactemail:t,contactphone:n,itemno:a,itemqty:s})}}A([o],T.prototype,"fetchServiceList",1),A([o],T.prototype,"getServiceSum",1),A([o],T.prototype,"fetchResources",1),A([o],T.prototype,"postResourceApply",1);const O=function(e,t){const n=new T(e);return n.currentLng=t,i((()=>{n.serviceList=void 0,n.pageIndex=0,n.totalRecords=0})),{serviceStore:n}};var P=a({name:"ServiceApplyTable",props:{t:{type:Function,required:!0},serviceStore:{type:Object,required:!0}},setup(e){const{t:t,serviceStore:n}=e;let r=s((()=>({current:n.pageIndex,total:n.totalRecords})));const o=[{title:t("planBooth.standno"),dataIndex:"standno"},{title:t("planBooth.exhibitor"),dataIndex:"exhibitor"},{title:t("planBooth.company"),dataIndex:"company"},{title:t("planBooth.serviceRent.contactperson"),dataIndex:"contactperson"},{title:t("planBooth.serviceRent.contactemail"),dataIndex:"contactemail"},{title:t("planBooth.serviceRent.contactphone"),dataIndex:"contactphone"},{title:t("planBooth.company"),dataIndex:"company"},{title:t("planBooth.resource.itemno"),dataIndex:"reserveitemno"},{title:t("planBooth.resource.itemname"),dataIndex:"itemname"},{title:t("planBooth.resource.description"),dataIndex:"description"},{title:t("planBooth.resource.qty"),dataIndex:"reserveqty"},{title:t("planBooth.resource.unitprice"),dataIndex:"unitprice"},{title:t("planBooth.createtime"),dataIndex:"createtime"},{title:t("planBooth.status"),dataIndex:"status",fixed:"right",customRender:({record:e})=>l("b",null,[t(`planBooth.statustype[${e.status}]`)])}];return()=>l("div",{class:"pd_tb_20"},[l(h,{size:"small",bordered:!0,rowKey:"reserveid",columns:o,loading:n.loading,scroll:{x:1400,y:500},dataSource:n.serviceList,pagination:{current:r.value.current,total:r.value.total,onChange:e=>{n.fetchServiceList(e)}}},{title:()=>l("h3",null,[t(`planBooth.serviceRent.list_${n.reserveType}`)]),footer:()=>l("h3",{class:"text_red text_right"},[t("planBooth.resource.totalsum"),c(": "),n.sumServicePrice])})])}}),_=a({name:"ServiceResourceList",props:{t:{type:Function,required:!0},serviceStore:{type:Object,required:!0}},setup(e){const{t:t,serviceStore:n}=e,r=[{title:t("planBooth.resource.itemno"),dataIndex:"itemno",width:150},{title:t("planBooth.resource.itemname"),dataIndex:"itemname",width:150},{title:t("planBooth.resource.description"),dataIndex:"description"},{title:t("planBooth.resource.unitprice"),dataIndex:"unitprice",width:150},{title:t("planBooth.resource.qty"),dataIndex:"itemno",width:100,customRender:({record:e})=>l(y,{value:e.quantity,"onUpdate:value":t=>e.quantity=t,min:0,precision:0,size:"small",style:{width:"50px"},onChange:()=>{n.caculateSum()}},null)}];return()=>l(h,{dataSource:n.resourceList,rowKey:"itemno",columns:r,scroll:{y:"60vh"},pagination:!1},null)}});function C(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!v(e)}var F=a({setup(){const{t:e,locale:t}=S();let n="en-US"===t.value?"en":"cn";const{serviceStore:r}=O(I.furniture,n),{serviceStore:o}=O(I.power,n),{serviceStore:i}=O(I.other,n),a=p(I.furniture),s=p(),v={furniture:r,power:o,other:i};u((()=>{for(let e in v)v[e].fetchServiceList(0,10),v[e].getServiceSum()}));const h=p(!1),y=d({company:"",contactemail:"",contactphone:"",contactperson:"",createtime:"",description:"",exhibitor:"",itemname:"",reserveid:0,reserveitemno:"",reserveqty:0,standno:"",status:"",unitprice:0}),L=t=>{x.confirm({centered:!0,title:e("planBooth.serviceRent."+(1===t?"serviceApply":"formTitle")),content:l("img",{style:"height:65vh;",src:1===t?"/assets/Furniture1.44075b44.jpg":"/assets/Furniture2.07d9b4a8.jpg"},null),width:"70vh",okText:e("planBooth.serviceRent.download"),cancelText:e("planBooth.serviceRent.cancel"),onOk:()=>{window.open(1===t?"//wapp.itb-china.com/Pages/pc/pages/logistics/serviceRental/service/Furniture1.jpg":"//wapp.itb-china.com/Pages/pc/pages/logistics/serviceRental/service/Furniture2.jpg")}})},q=()=>{h.value=!1},k=async t=>{""===y.contactperson||""===y.contactemail||""===y.contactphone?j.info(e("planBooth.serviceRent.alertinfo")):(a.value=t,await v[t].fetchResources(),h.value=!0)},A=()=>{const t=a.value;v[t].sumApplyPrice>0&&x.confirm({content:l("div",null,[e("planBooth.serviceRent.submitinfo"),l("br",null,null),e("planBooth.serviceRent.submitinfo2")]),onOk:async()=>{await v[t].postResourceApply(y.contactperson,y.contactemail,y.contactphone),h.value=!1,v[t].fetchServiceList(0,10),v[t].getServiceSum(),s.value.resetFields()},okText:e("planBooth.serviceRent.sendApply"),onCancel:()=>{},cancelText:e("planBooth.serviceRent.cancel")})};return()=>{let t,n,p;return l(m,null,[l("div",{class:w.formInfoSection},[l("img",{src:"/assets/furniture.d51494e7.jpg"},null),l("div",null,[l("h2",{class:"text_red"},[e("planBooth.serviceRent.formTitle")]),l("div",null,[e("planBooth.serviceRent.info1")]),l("div",null,[e("planBooth.serviceRent.info2")]),l("div",null,[l("b",null,[e("planBooth.serviceRent.info3")]),e("planBooth.serviceRent.info4")]),l("div",null,[e("planBooth.serviceRent.info4_1"),l("span",{style:"color:red;font-weight:bold;"},[e("planBooth.serviceRent.info4_2")]),e("planBooth.serviceRent.info4_3")]),l("div",null,[e("planBooth.serviceRent.info5",{email:"cai.wl@sunhills.cn"})]),l("div",null,[e("planBooth.serviceRent.info6")]),l("div",null,[e("planBooth.serviceRent.info7")]),l("div",null,[e("planBooth.serviceRent.info8",{email:"cherry.gong@syma.com.cn"})]),l("div",null,[e("planBooth.serviceRent.info9")]),l("div",null,[e("planBooth.serviceRent.info10")]),l("div",null,[e("planBooth.serviceRent.info11",{email:"crystal.jiang@syma.com.cn"})]),l("div",null,[e("planBooth.serviceRent.info12")])])]),l("div",null,[e("planBooth.serviceRent.furniturepic")," ",l("img",{onClick:()=>{L(1)},src:"/assets/funitureicon.c560a427.png",width:"32",class:"cursor_hand"},null),l("img",{onClick:()=>{L(2)},src:"/assets/funitureicon2.d851f585.png",width:"32",class:"cursor_hand"},null),l("br",null,null),l("br",null,null),l(f,{ref:s,model:y},{default:()=>[l(g,{gutter:20},{default:()=>[l(b,{span:12},{default:()=>[l(f.Item,{name:"contactperson",label:e("planBooth.serviceRent.contactperson"),rules:{required:!0,message:""}},{default:()=>[l(B,{type:"text",value:y.contactperson,"onUpdate:value":e=>y.contactperson=e},null)]})]}),l(b,{span:12},{default:()=>[l(f.Item,{name:"contactemail",label:e("planBooth.serviceRent.contactemail"),rules:{required:!0,message:""}},{default:()=>[l(B,{type:"text",value:y.contactemail,"onUpdate:value":e=>y.contactemail=e},null)]})]})]}),l(g,{gutter:20},{default:()=>[l(b,{span:12},{default:()=>[l(f.Item,{name:"contactphone",label:e("planBooth.serviceRent.contactphone"),rules:{required:!0,message:""}},{default:()=>[l(B,{type:"text",value:y.contactphone,"onUpdate:value":e=>y.contactphone=e},null)]})]})]})]}),l("div",{style:"text-align:center;"},[l(R,{type:"primary",onClick:()=>{k(I.furniture)},disabled:!r.serviceList||r.serviceList.length>0,loading:v[I.furniture].loading},C(t=e("planBooth.serviceRent.serviceApply"))?t:{default:()=>[t]}),c(" "),l(R,{type:"primary",onClick:()=>{k(I.power)},disabled:!o.serviceList||o.serviceList.length>0,loading:v[I.power].loading},C(n=e("planBooth.serviceRent.serviceApply2"))?n:{default:()=>[n]}),c(" "),l(R,{type:"primary",onClick:()=>{k(I.other)},disabled:!i.serviceList||i.serviceList.length>0,loading:v[I.other].loading},C(p=e("planBooth.serviceRent.serviceApply3"))?p:{default:()=>[p]})])]),l(x,{visible:h.value,"onUpdate:visible":e=>h.value=e,width:1080,centered:!0,title:e(`planBooth.serviceRent.list_${a.value}`)},{default:()=>[h.value&&l(_,{t:e,serviceStore:v[a.value]},null)],footer:()=>{let t,n;return l(m,null,[l("b",{class:"text_red",style:{marginRight:"3em"}},[e("planBooth.resource.totalsum"),c(": "),v[a.value].sumApplyPrice]),l(R,{key:"back",onClick:q},C(t=e("common.cancel"))?t:{default:()=>[t]}),l(R,{key:"submit",type:"primary",onClick:A},C(n=e("common.submit"))?n:{default:()=>[n]})])}}),l(P,{t:e,serviceStore:r},null),l(P,{t:e,serviceStore:o},null),l(P,{t:e,serviceStore:i},null)])}}});export default F;
