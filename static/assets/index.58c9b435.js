import{d as W,c as X,w as Z,k as e,i as ee,t as ae,u as te,F as se,z as re}from"./@vue.92a87908.js";import{u as le,M as ne,R as p,S as f,a as oe,r as de}from"./index.701896b1.js";import{M as S}from"./MainSectionHead.1265a007.js";import{u as ie}from"./CalendarStore.c541308c.js";import{J as ce}from"./@rpdg.bcb9de75.js";import{F as m,j as J,k as g,b as P,l as q,o as T,g as ue,m as _}from"./ant-design-vue.3fff3ad8.js";import{h as i}from"./moment.29305b8e.js";import{u as me}from"./vue-i18n.28a5a3dd.js";import{s as c}from"./index.module.6e348a91.js";import{s as b}from"./index.module.ac491f04.js";import{d as h}from"./avator_red.2a3a1020.js";import{m as pe}from"./@ant-design.754a3742.js";import"./nprogress.35503c85.js";import"./vue-router.2704beb0.js";import"./axios.7aed06b8.js";import"./@babel.288dabcc.js";import"./regenerator-runtime.8463e994.js";import"./omit.js.0925d6dc.js";import"./lodash-es.647f38fa.js";import"./warning.ca82f8e0.js";import"./resize-observer-polyfill.8deb1e21.js";import"./async-validator.1fa0d626.js";import"./scroll-into-view-if-needed.c68eec67.js";import"./compute-scroll-into-view.6058b3be.js";import"./vue-types.6e6d84ba.js";import"./dom-align.f1b5d360.js";import"./@intlify.19fb0a11.js";import"./source-map.e9534891.js";import"./vue.18c06692.js";import"./@ctrl.2e36ce53.js";function j(u){return typeof u=="function"||Object.prototype.toString.call(u)==="[object Object]"&&!ee(u)}var Ge=W({props:{isOnline:{type:Number,required:!0}},name:"Schedule",setup(u){var E,x,C;const{t:l}=me(),{appStore:n}=oe(),{authenStore:t}=le(),{calendarStore:K}=ie(),a=(E=t.user)==null?void 0:E.timeZone[0],{isOnline:w}=u,s=ce.get(ne),H={from:i((x=n.exhibitionDate)==null?void 0:x.onlineBeginDateTime).startOf("day"),to:i((C=n.exhibitionDate)==null?void 0:C.onlineEndDateTime).endOf("day")},v=i().startOf("day").add(1,"day");let r=X({topic:l("calendar.schedule_meeting.topic_text",{a:n.isEn?s.company:s.company_cn,b:n.isEn?s.company:s.company_cn}),startDate:v.diff(i(H.from),"day")>=0?v:i(H.from).add(1,"day"),endDate:v,warning:!1,showChooser:!1,destination:null,product:null});U();function U(){r.endDate=i(r.startDate).add(30,"minute")}Z(()=>r.startDate,U);async function Q(){try{await K.addSchedule({IsOnline:w,ToBarcode:s.employee_id,BeginDateTime:r.startDate.format("YYYY-MM-DD HH:mm:00"),EndDateTime:r.endDate.format("YYYY-MM-DD HH:mm:00")})?(_.success(l("common.success")),de.push("/calendar")):_.error(l("common.failed"))}catch(o){switch(o.message){case"message_error_01":case"message_error_02":case"message_error_03":case"error_msg_001":case"error_msg_002":case"error_msg_003":_.error(l(`calendar.invite_errors.${o.message}`));break;default:_.error(o.message)}}}return()=>{var Y,M,N,O,k,z,$,A,R,B,F,L,V,G;let o,D,y,I;return e(se,null,[e(S,{redLead:!1},j(o=l("calendar.schedule_meeting.title"))?o:{default:()=>[o]}),e("div",{class:"pd_20 bg_white"},[e(m,null,{default:()=>[w===1&&e(J,{gutter:20},{default:()=>[ae(e(g,{span:12},{default:()=>[e("span",{class:b.label},[l("calendar.schedule_meeting.topic")]),e(m.Item,null,{default:()=>[e(P,{type:"text",disabled:!0,value:r.topic},null)]})]}),[[re,!1]]),e(g,{span:12},{default:()=>[e("span",{class:b.label},[l("calendar.schedule_meeting.my_time_zone")]),e(m.Item,null,{default:()=>[e(P,{disabled:!0,type:"text",value:`${a==null?void 0:a.utc} ${n.isEn?a==null?void 0:a.timezone_en:a==null?void 0:a.timezone_cn}`},null)]})]})]}),e(J,{gutter:20},{default:()=>[e(g,{span:12},{default:()=>[e("span",{class:b.label},[l("calendar.schedule_meeting.start")]),e(m.Item,{name:"startDatetime"},{default:()=>[e(q,{value:r.startDate,"onUpdate:value":d=>r.startDate=d,allowClear:!1},null),e(T,{format:"HH:mm",value:r.startDate,"onUpdate:value":d=>r.startDate=d,minuteStep:30,allowClear:!1},null)]})]}),e(g,{span:12},{default:()=>[e("span",{class:b.label},[l("calendar.schedule_meeting.end")]),e(m.Item,{name:"endDatetime"},{default:()=>[e(q,{value:r.endDate,"onUpdate:value":d=>r.endDate=d,disabled:!0},null),e(T,{value:r.endDate,"onUpdate:value":d=>r.endDate=d,format:"HH:mm",disabled:!0},null)]})]})]}),e("hr",null,null),e("p",null,[l("calendar.time_zone")," ",`(${a==null?void 0:a.utc}) ${n.isEn?a==null?void 0:a.timezone_en:a==null?void 0:a.timezone_cn}`]),e("p",null,[e(pe,null,null),te(" "),r.startDate.format("YYYY-MM-DD HH:mm")]),e("p",{style:"color:red;"},[l("calendar.schedule_meeting.goodtips")])]})]),e(S,null,j(D=l("calendar.schedule_meeting.contactor"))?D:{default:()=>[D]}),e("div",{class:`pd_20 bg_white  ${c.contactListItem}`},[e("img",{src:((Y=t.user)==null?void 0:Y.roleName)===p.buyer?s.HeadImageUrl!=null&&s.HeadImageUrl!=""?f+s.HeadImageUrl:h:((M=t.user)==null?void 0:M.headImageUrl)!=null&&((N=t.user)==null?void 0:N.headImageUrl)!=""?f+((O=t.user)==null?void 0:O.headImageUrl):h,class:c.avatar},null),e("div",{class:c.profile},[((k=t.user)==null?void 0:k.roleName)===p.buyer?n.isEn?s.company:s.company_cn:n.isEn?(z=t.user)==null?void 0:z.company:($=t.user)==null?void 0:$.companyCn])]),e(S,null,j(y=l("calendar.schedule_meeting.buyer"))?y:{default:()=>[y]}),e("div",{class:`pd_20 bg_white  ${c.contactListItem}`},[e("img",{src:((A=t.user)==null?void 0:A.roleName)===p.buyer?((R=t.user)==null?void 0:R.headImageUrl)!=null&&((B=t.user)==null?void 0:B.headImageUrl)!=""?f+((F=t.user)==null?void 0:F.headImageUrl):h:s.HeadImageUrl!=null&&s.HeadImageUrl!=""?f+s.HeadImageUrl:h,class:c.avatar},null),e("div",{class:c.profile},[((L=t.user)==null?void 0:L.roleName)===p.buyer?n.isEn?(V=t.user)==null?void 0:V.company:(G=t.user)==null?void 0:G.companyCn:n.isEn?s.company:s.company_cn])]),e("p",{class:"pd_t_20"},[e(ue,{type:"primary",onClick:Q,style:{width:"150px"}},j(I=l("calendar.schedule_meeting.schedule"))?I:{default:()=>[I]})])])}}});export{Ge as default};
