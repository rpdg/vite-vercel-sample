var t=Object.defineProperty,e=(e,a,n)=>(((e,a,n)=>{a in e?t(e,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[a]=n})(e,"symbol"!=typeof a?a+"":a,n),n);import{B as a,p as n,l as i}from"./index.71624568.js";import{F as l,l as r,m as o,I as p,o as s,R as d,p as u,W as m,j as c,k as y,n as f,T as v}from"./ant-design-vue.a66dda27.js";import{h as b}from"./moment.29305b8e.js";import{u as g}from"./vue-i18n.da31ebd6.js";import{a7 as M,k as T,r as h,a5 as j,al as x,a4 as I,M as w,av as P,c as k}from"./@vue.d2268549.js";import"./vue-router.fb6e63db.js";import"./axios.a57df465.js";import"./@ant-design.d3d66979.js";import"./@ctrl.2e36ce53.js";import"./nprogress.3e43c680.js";import"./@babel.c1abb07f.js";import"./regenerator-runtime.df0ff768.js";import"./omit.js.0925d6dc.js";import"./lodash-es.4607ccff.js";import"./warning.ca82f8e0.js";import"./resize-observer-polyfill.8deb1e21.js";import"./async-validator.1fa0d626.js";import"./scroll-into-view-if-needed.c68eec67.js";import"./compute-scroll-into-view.6058b3be.js";import"./vue-types.6e6d84ba.js";import"./dom-align.f1b5d360.js";import"./@intlify.c2b61631.js";import"./source-map.3671d69c.js";import"./vue.f1e4fb87.js";var R=Object.defineProperty,O=Object.getOwnPropertyDescriptor,U=(t,e,a,n)=>{for(var i,l=n>1?void 0:n?O(e,a):e,r=t.length-1;r>=0;r--)(i=t[r])&&(l=(n?i(e,a,l):i(l))||l);return n&&l&&R(e,a,l),l};class S extends a{constructor(){super(),e(this,"currentRecord"),e(this,"list"),e(this,"pageIndex"),e(this,"pageSize"),e(this,"totalRecords"),this.pageIndex=0,this.totalRecords=0,this.pageSize=10}async fetchList(t,e=10){let a=await n("/operation/Getletterlistbyuser",{pageIndex:t,pageSize:e});this.list=a.results,this.pageIndex=t,this.totalRecords=a.totalRecord}async addLetter(t){return await n("Operation/AddLetter",t)}async downloadPdf(t){let e=await n("Operation/CreatePDF",{letterid:t});window.open(e.filename,"_blank")}}U([i],S.prototype,"fetchList",1),U([i],S.prototype,"addLetter",1),U([i],S.prototype,"downloadPdf",1);const L=new S,F=function(){return{invitationStore:L}};var _="_formInfoSection_oi42b_1";function z(t){return"function"==typeof t||"[object Object]"===Object.prototype.toString.call(t)&&!x(t)}const C=l.useForm;var D=M({name:"InvitationForm",setup(){const t="YYYY-MM-DD",{t:e}=g(),{invitationStore:a}=F(),n=T(),i=h({countryname:"",username:"",position:"",gender:"Male",dateofbirth:"",nationality:"",passportnumber:"",passportvalidity:"",employer:"",starttime:"",stoptime:"",iknow:!1,residence:[],dateofbirthP:void 0,passportvalidityP:void 0});const v=h({dateofbirthP:[{required:!0,message:e("planMyTrip.dateofbirthTip")}],passportvalidityP:[{required:!0,message:e("planMyTrip.passportvalidityTip")}],residence:[{validator:async(t,a)=>a?a.length<2?Promise.reject(e("planMyTrip.errortimeinfo")):Promise.resolve():Promise.reject(e("planMyTrip.errortimeinfo"))}]}),{resetFields:M}=C(i,v);async function x(){var l,r,o,p;try{await n.value.validate(),i.dateofbirth=null==(l=i.dateofbirthP)?void 0:l.format(t),i.passportvalidity=null==(r=i.passportvalidityP)?void 0:r.format(t),i.starttime=null==(o=i.residence[0])?void 0:o.format(t),i.stoptime=null==(p=i.residence[1])?void 0:p.format(t),await a.addLetter(i)&&(f.success({message:e("planMyTrip.submitinfo"),placement:"topRight"}),M(),a.fetchList(0))}catch(s){}}return()=>{let t,f,g,T,h;return j(w,null,[j("div",{class:_},[j("img",{src:"/assets/pic.1ad2cc7c.jpg"},null),j("div",null,[j("h3",{class:"text_red"},[e("planMyTrip.formtitle")]),j("p",null,[e("planMyTrip.topinfo1")]),j("p",null,[e("planMyTrip.topinfo2",{email:"contact@itb-china.com"})]),j("p",null,[e("planMyTrip.topinfo3")])])]),j(l,{ref:n,model:i,rules:v},{default:()=>[j(r,{gutter:20},{default:()=>[j(o,{span:12},{default:()=>[j(l.Item,{name:"countryname",label:e("planMyTrip.countryname")},{default:()=>[j(p,{type:"text",value:i.countryname,"onUpdate:value":t=>i.countryname=t},null)]})]}),j(o,{span:12},{default:()=>[j(l.Item,{name:"username",label:e("planMyTrip.username")},{default:()=>[j(p,{type:"text",value:i.username,"onUpdate:value":t=>i.username=t},null)]})]})]}),j(r,{gutter:20},{default:()=>[j(o,{span:12},{default:()=>[j(l.Item,{name:"position",label:e("planMyTrip.position")},{default:()=>[j(p,{type:"text",value:i.position,"onUpdate:value":t=>i.position=t},null)]})]}),j(o,{span:12},{default:()=>[j(l.Item,{name:"gender",label:e("planMyTrip.gender")},{default:()=>[j(s,{value:i.gender,"onUpdate:value":t=>i.gender=t},{default:()=>[j(d,{value:"Male"},z(t=e("planMyTrip.gendercontent[0]"))?t:{default:()=>[t]}),j(d,{value:"Female"},z(f=e("planMyTrip.gendercontent[1]"))?f:{default:()=>[f]})]})]})]})]}),j(r,{gutter:20},{default:()=>[j(o,{span:12},{default:()=>[j(l.Item,{name:"dateofbirthP",label:e("planMyTrip.dateofbirth")},{default:()=>[j(u,{style:{width:"100%"},value:i.dateofbirthP,"onUpdate:value":t=>i.dateofbirthP=t},null)]})]}),j(o,{span:12},{default:()=>[j(l.Item,{name:"nationality",label:e("planMyTrip.nationality")},{default:()=>[j(p,{type:"text",value:i.nationality,"onUpdate:value":t=>i.nationality=t},null)]})]})]}),j(r,{gutter:20},{default:()=>[j(o,{span:12},{default:()=>[j(l.Item,{name:"passportnumber",label:e("planMyTrip.passportnumber")},{default:()=>[j(p,{type:"text",value:i.passportnumber,"onUpdate:value":t=>i.passportnumber=t},null)]})]}),j(o,{span:12},{default:()=>[j(l.Item,{name:"passportvalidityP",label:e("planMyTrip.passportvalidity")},{default:()=>[j(u,{style:{width:"100%"},value:i.passportvalidityP,"onUpdate:value":t=>i.passportvalidityP=t},null)]})]})]}),j(r,{gutter:20},{default:()=>[j(o,{span:12},{default:()=>[j(l.Item,{name:"employer",label:e("planMyTrip.employer")},{default:()=>[j(p,{type:"text",value:i.employer,"onUpdate:value":t=>i.employer=t},null)]})]}),j(o,{span:12},{default:()=>[j(l.Item,{name:"residence",label:e("planMyTrip.residence")},{default:()=>[j(m,{style:{width:"100%"},value:i.residence,"onUpdate:value":t=>i.residence=t,disabledDate:t=>t<b("2021-05-03").startOf("day")||t>b("2021-05-10").endOf("day")},null)]})]})]}),j(r,null,{default:()=>[j(l.Item,{name:"iknow"},{default:()=>[j(c,{checked:i.iknow,"onUpdate:checked":t=>i.iknow=t},z(g=e("planMyTrip.formatattention"))?g:{default:()=>[g]})]})]}),j(r,null,{default:()=>[j("p",{class:"text_red"},[e("planMyTrip.formatattention2"),I(" "),j("br",null,null),I(" "),e("planMyTrip.formatattention3")])]}),j(r,{type:"flex",gutter:20},{default:()=>[j(o,{flex:1,style:{textAlign:"right"}},{default:()=>[j(y,{type:"primary",disabled:!i.iknow,loading:a.loading,onClick:x},z(T=e("planMyTrip.sendApply"))?T:{default:()=>[T]})]}),j(o,{flex:1},{default:()=>[j(y,{onClick:M},z(h=e("planMyTrip.reset"))?h:{default:()=>[h]})]})]})]})])}}});const $={Table:M({name:"InvitationTable",setup(){const{t:t}=g(),{invitationStore:e}=F();P((()=>{e.fetchList(0)}));let a=k((()=>({current:e.pageIndex,total:e.totalRecords})));const n=[{title:t("planMyTrip.countryname"),dataIndex:"countryname"},{title:t("planMyTrip.username"),dataIndex:"username"},{title:t("planMyTrip.gender"),dataIndex:"gender"},{title:t("planMyTrip.dateofbirth"),dataIndex:"dateofbirth",customRender:({record:t})=>`${t.dateofbirth.split(" ")[0]}`},{title:t("planMyTrip.position"),dataIndex:"position"},{title:t("planMyTrip.nationality"),dataIndex:"nationality"},{title:t("planMyTrip.passportnumber"),dataIndex:"passportnumber"},{title:t("planMyTrip.passportvalidity"),dataIndex:"passportvalidity",customRender:({record:t})=>`${t.passportvalidity.split(" ")[0]}`},{title:t("planMyTrip.employer"),dataIndex:"employer"},{title:t("planMyTrip.residence"),dataIndex:"strattime",customRender:({record:t})=>`${t.starttime.split(" ")[0]} -- ${t.stoptime.split(" ")[0]}`},{title:t("planMyTrip.createtime"),dataIndex:"createtime"},{title:t("planMyTrip.status"),dataIndex:"status",customRender:({record:e})=>t(`planMyTrip.statustype[${e.status}]`)},{title:t("planMyTrip.operation"),dataIndex:"invitationid",align:"center",fixed:"right",customRender({record:a}){if("1"===a.status){let i;return j(y,{type:"link",onClick:()=>{e.downloadPdf(a.invitationid)}},"function"==typeof(n=i=t("planMyTrip.operationbutton"))||"[object Object]"===Object.prototype.toString.call(n)&&!x(n)?i:{default:()=>[i]})}var n}}];return()=>j("div",{class:"pd_tb_20"},[j(v,{size:"small",bordered:!0,rowKey:"invitationid",dataSource:e.list,columns:n,loading:e.loading,scroll:{x:1400,y:500},pagination:{current:a.value.current,total:a.value.total,onChange:t=>{e.fetchList(t)}}},{title:()=>j("h3",null,[t("planMyTrip.list")])})])}}),Form:D};var Y=M({name:"PlanMyInvitation",setup:()=>()=>j(w,null,[j($.Form,null,null),j($.Table,null,null)])});export{Y as default};
