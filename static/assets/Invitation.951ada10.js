var e=Object.defineProperty,t=(t,a,n)=>(((t,a,n)=>{a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n})(t,"symbol"!=typeof a?a+"":a,n),n);import{B as a,p as n,l as i}from"./index.ffebe535.js";import{F as l,m as r,n as o,I as s,o as p,R as d,p as u,W as m,k as c,l as y,h as f,T as v}from"./ant-design-vue.caf0e0b9.js";import{h as b}from"./moment.29305b8e.js";import{u as g}from"./vue-i18n.bbad715b.js";import{s as h}from"./index.module.017d0403.js";import{a2 as T,k as M,r as j,a0 as x,ag as I,$ as w,I as P,aq as k,c as R}from"./@vue.5723de44.js";import"./vue-router.0532eeed.js";import"./@ant-design.503097a2.js";import"./@ctrl.2e36ce53.js";import"./nprogress.3e43c680.js";import"./axios.a57df465.js";import"./@babel.dc475c8c.js";import"./regenerator-runtime.8463e994.js";import"./omit.js.0925d6dc.js";import"./lodash-es.60ec16aa.js";import"./warning.4abaefa0.js";import"./resize-observer-polyfill.8deb1e21.js";import"./async-validator.1fa0d626.js";import"./scroll-into-view-if-needed.c68eec67.js";import"./compute-scroll-into-view.6058b3be.js";import"./vue-types.6e6d84ba.js";import"./dom-align.f1b5d360.js";import"./@intlify.c2b61631.js";import"./source-map.3671d69c.js";import"./vue.3a1030aa.js";var O=Object.defineProperty,S=Object.getOwnPropertyDescriptor,U=(e,t,a,n)=>{for(var i,l=n>1?void 0:n?S(t,a):t,r=e.length-1;r>=0;r--)(i=e[r])&&(l=(n?i(t,a,l):i(l))||l);return n&&l&&O(t,a,l),l};class L extends a{constructor(){super(),t(this,"currentRecord"),t(this,"list"),t(this,"pageIndex"),t(this,"pageSize"),t(this,"totalRecords"),this.pageIndex=0,this.totalRecords=0,this.pageSize=10}async fetchList(e,t){let a=await n("/operation/Getletterlistbyuser",{pageIndex:e,pageSize:t||this.pageSize});this.list=a.results,this.pageIndex=e,this.totalRecords=a.totalRecord}async addLetter(e){return await n("Operation/AddLetter",e)}async downloadPdf(e){let t=await n("Operation/CreatePDF",{letterid:e});window.open(t.filename,"_blank")}}U([i],L.prototype,"fetchList",1),U([i],L.prototype,"addLetter",1),U([i],L.prototype,"downloadPdf",1);const F=new L,z=function(){return{invitationStore:F}};function $(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!I(e)}const C=l.useForm;var D=T({name:"InvitationForm",setup(){const e="YYYY-MM-DD",{t:t}=g(),{invitationStore:a}=z(),n=M(),i=j({countryname:"",username:"",position:"",gender:"Male",dateofbirth:"",nationality:"",passportnumber:"",passportvalidity:"",employer:"",starttime:"",stoptime:"",iknow:!1,residence:[],dateofbirthP:void 0,passportvalidityP:void 0});const v=j({dateofbirthP:[{required:!0,message:t("planMyTrip.dateofbirthTip")}],passportvalidityP:[{required:!0,message:t("planMyTrip.passportvalidityTip")}],residence:[{validator:async(e,a)=>a?a.length<2?Promise.reject(t("planMyTrip.errortimeinfo")):Promise.resolve():Promise.reject(t("planMyTrip.errortimeinfo"))}]}),{resetFields:T}=C(i,v);async function I(){var l,r,o,s;try{await n.value.validate(),i.dateofbirth=null==(l=i.dateofbirthP)?void 0:l.format(e),i.passportvalidity=null==(r=i.passportvalidityP)?void 0:r.format(e),i.starttime=null==(o=i.residence[0])?void 0:o.format(e),i.stoptime=null==(s=i.residence[1])?void 0:s.format(e),await a.addLetter(i)&&(f.success({message:t("planMyTrip.submitinfo"),placement:"topRight"}),T(),a.fetchList(0))}catch(p){}}return()=>{let e,f,g,M,j;return x(P,null,[x("div",{class:h.formInfoSection},[x("img",{src:"/assets/pic.ff892424.jpg"},null),x("div",null,[x("h3",{class:"text_red"},[t("planMyTrip.formtitle")]),x("span",null,[t("planMyTrip.topinfo1")]),x("span",null,[t("planMyTrip.topinfo2",{email:"contact@itb-china.com"})]),x("span",null,[t("planMyTrip.topinfo3")])])]),x(l,{ref:n,model:i,rules:v},{default:()=>[x(r,{gutter:20},{default:()=>[x(o,{span:12},{default:()=>[x(l.Item,{name:"countryname",label:t("planMyTrip.countryname")},{default:()=>[x(s,{type:"text",value:i.countryname,"onUpdate:value":e=>i.countryname=e},null)]})]}),x(o,{span:12},{default:()=>[x(l.Item,{name:"username",label:t("planMyTrip.username")},{default:()=>[x(s,{type:"text",value:i.username,"onUpdate:value":e=>i.username=e},null)]})]})]}),x(r,{gutter:20},{default:()=>[x(o,{span:12},{default:()=>[x(l.Item,{name:"position",label:t("planMyTrip.position")},{default:()=>[x(s,{type:"text",value:i.position,"onUpdate:value":e=>i.position=e},null)]})]}),x(o,{span:12},{default:()=>[x(l.Item,{name:"gender",label:t("planMyTrip.gender")},{default:()=>[x(p,{value:i.gender,"onUpdate:value":e=>i.gender=e},{default:()=>[x(d,{value:"Male"},$(e=t("planMyTrip.gendercontent[0]"))?e:{default:()=>[e]}),x(d,{value:"Female"},$(f=t("planMyTrip.gendercontent[1]"))?f:{default:()=>[f]})]})]})]})]}),x(r,{gutter:20},{default:()=>[x(o,{span:12},{default:()=>[x(l.Item,{name:"dateofbirthP",label:t("planMyTrip.dateofbirth")},{default:()=>[x(u,{style:{width:"100%"},value:i.dateofbirthP,"onUpdate:value":e=>i.dateofbirthP=e},null)]})]}),x(o,{span:12},{default:()=>[x(l.Item,{name:"nationality",label:t("planMyTrip.nationality")},{default:()=>[x(s,{type:"text",value:i.nationality,"onUpdate:value":e=>i.nationality=e},null)]})]})]}),x(r,{gutter:20},{default:()=>[x(o,{span:12},{default:()=>[x(l.Item,{name:"passportnumber",label:t("planMyTrip.passportnumber")},{default:()=>[x(s,{type:"text",value:i.passportnumber,"onUpdate:value":e=>i.passportnumber=e},null)]})]}),x(o,{span:12},{default:()=>[x(l.Item,{name:"passportvalidityP",label:t("planMyTrip.passportvalidity")},{default:()=>[x(u,{style:{width:"100%"},value:i.passportvalidityP,"onUpdate:value":e=>i.passportvalidityP=e},null)]})]})]}),x(r,{gutter:20},{default:()=>[x(o,{span:12},{default:()=>[x(l.Item,{name:"employer",label:t("planMyTrip.employer")},{default:()=>[x(s,{type:"text",value:i.employer,"onUpdate:value":e=>i.employer=e},null)]})]}),x(o,{span:12},{default:()=>[x(l.Item,{name:"residence",label:t("planMyTrip.residence")},{default:()=>[x(m,{style:{width:"100%"},value:i.residence,"onUpdate:value":e=>i.residence=e,disabledDate:e=>e<b("2021-11-20").startOf("day")||e>b("2021-11-28").endOf("day")},null)]})]})]}),x(r,null,{default:()=>[x(l.Item,{name:"iknow"},{default:()=>[x(c,{checked:i.iknow,"onUpdate:checked":e=>i.iknow=e},$(g=t("planMyTrip.formatattention"))?g:{default:()=>[g]})]})]}),x(r,null,{default:()=>[x("p",{class:"text_red"},[t("planMyTrip.formatattention2"),w(" "),x("br",null,null),w(" "),t("planMyTrip.formatattention3")])]}),x(r,{type:"flex",gutter:20},{default:()=>[x(o,{flex:1,style:{textAlign:"right"}},{default:()=>[x(y,{type:"primary",disabled:!i.iknow,loading:a.loading,onClick:I},$(M=t("planMyTrip.sendApply"))?M:{default:()=>[M]})]}),x(o,{flex:1},{default:()=>[x(y,{onClick:T},$(j=t("planMyTrip.reset"))?j:{default:()=>[j]})]})]})]})])}}});const _={Table:T({name:"InvitationTable",setup(){const{t:e}=g(),{invitationStore:t}=z();k((()=>{t.fetchList(0)}));let a=R((()=>({current:t.pageIndex,total:t.totalRecords})));const n=[{title:e("planMyTrip.countryname"),dataIndex:"countryname"},{title:e("planMyTrip.username"),dataIndex:"username"},{title:e("planMyTrip.gender"),dataIndex:"gender"},{title:e("planMyTrip.dateofbirth"),dataIndex:"dateofbirth",customRender:({record:e})=>`${e.dateofbirth.split(" ")[0]}`},{title:e("planMyTrip.position"),dataIndex:"position"},{title:e("planMyTrip.nationality"),dataIndex:"nationality"},{title:e("planMyTrip.passportnumber"),dataIndex:"passportnumber"},{title:e("planMyTrip.passportvalidity"),dataIndex:"passportvalidity",customRender:({record:e})=>`${e.passportvalidity.split(" ")[0]}`},{title:e("planMyTrip.employer"),dataIndex:"employer"},{title:e("planMyTrip.residence"),dataIndex:"strattime",customRender:({record:e})=>`${e.starttime.split(" ")[0]} -- ${e.stoptime.split(" ")[0]}`},{title:e("planMyTrip.createtime"),dataIndex:"createtime"},{title:e("planMyTrip.status"),dataIndex:"status",customRender:({record:t})=>e(`planMyTrip.statustype[${t.status}]`)},{title:e("planMyTrip.operation"),dataIndex:"invitationid",align:"center",fixed:"right",customRender({record:a}){if("1"===a.status){let i;return x(y,{type:"link",onClick:()=>{t.downloadPdf(a.invitationid)}},"function"==typeof(n=i=e("planMyTrip.operationbutton"))||"[object Object]"===Object.prototype.toString.call(n)&&!I(n)?i:{default:()=>[i]})}var n}}];return()=>x("div",{class:"pd_tb_20"},[x(v,{size:"small",bordered:!0,rowKey:"invitationid",dataSource:t.list,columns:n,loading:t.loading,scroll:{x:1400,y:500},pagination:{current:a.value.current,total:a.value.total,onChange:e=>{t.fetchList(e)}}},{title:()=>x("h3",null,[e("planMyTrip.list")])})])}}),Form:D};var Y=T({name:"PlanMyInvitation",setup:()=>()=>x(P,null,[x(_.Form,null,null),x(_.Table,null,null)])});export default Y;
